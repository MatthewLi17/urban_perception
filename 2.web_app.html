
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="assets/iclogo.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Creating and Deploying a Web-App - Urban Perceptions</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#creating-and-deploying-a-web-app" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Urban Perceptions" class="md-header__button md-logo" aria-label="Urban Perceptions" data-md-component="logo">
      
  
  <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 700 700"><defs><style>.cls-1{fill:none;}.cls-2{fill:#c7c9d0;}.cls-3{clip-path:url(#clip-path);}.cls-4{clip-path:url(#clip-path-3);}.cls-5{clip-path:url(#clip-path-4);}.cls-6{clip-path:url(#clip-path-6);}</style><clipPath id="clip-path"><rect class="cls-1" x="-227.75" y="-429.57" width="1092" height="1580"/></clipPath><clipPath id="clip-path-3"><rect class="cls-1" x="572.25" y="-429.57" width="1092" height="1580"/></clipPath><clipPath id="clip-path-4"><rect class="cls-1" x="-221" y="-430.32" width="1092" height="1580"/></clipPath><clipPath id="clip-path-6"><rect class="cls-1" x="579" y="-430.32" width="1092" height="1580"/></clipPath></defs><g id="Layer_4" data-name="Layer 4"><polygon class="cls-2" points="299.62 154.69 306.36 153.9 306.33 154.99 299.62 154.69"/><polygon class="cls-2" points="515.25 201.88 522.03 201.14 520.38 204.7 515.25 201.88"/><polygon class="cls-2" points="615.51 559.5 608.82 560.21 606.76 544.65 615.18 558.56 615.51 559.5"/><polyline class="cls-2" points="608.84 560.26 609.82 560.15 615.57 559.51 615.42 559.2 608.75 560.07"/><polyline class="cls-2" points="608.91 560.25 608.83 560.26 608.8 560.19"/></g><g id="Layer_2" data-name="Layer 2"><g class="cls-3"><g class="cls-3"><path class="cls-2" d="M352.45,423c109.1,0,204.49,55.09,256.38,137.26C593.75,421.33,484.72,313.53,352.45,313.53S111.21,421.28,96.12,560.22C148,478.05,243.35,423,352.45,423"/><path class="cls-2" d="M428.05,487.89c0,42.72-33.85,77.34-75.6,77.34s-75.59-34.62-75.59-77.34,33.84-77.33,75.59-77.33,75.6,34.62,75.6,77.33"/><polygon class="cls-2" points="237.76 383.12 162.74 430.28 29 207.61 104.02 160.44 237.76 383.12"/><rect class="cls-2" x="299.58" y="154.67" width="71.7" height="180.73"/><polygon class="cls-2" points="533.79 404.42 440.21 357.05 515.25 201.88 608.83 249.24 533.79 404.42"/></g></g><polyline class="cls-2" points="102.85 559.49 96.1 560.24 106.15 543.9"/><polygon class="cls-2" points="96.1 560.24 96.22 559.29 96.24 559.97 96.17 560.21 96.1 560.24"/></g><g class="cls-5"><g class="cls-5"><path d="M359.2,422.26c109.1,0,204.49,55.09,256.38,137.26C600.5,420.58,491.47,312.78,359.2,312.78S117.91,420.58,102.82,559.52c51.9-82.17,147.28-137.26,256.38-137.26"/><path d="M434.8,487.14c0,42.72-33.85,77.34-75.6,77.34s-75.59-34.62-75.59-77.34,33.84-77.33,75.59-77.33,75.6,34.62,75.6,77.33"/><polygon points="244.51 382.37 169.49 429.53 35.75 206.86 110.77 159.69 244.51 382.37"/><rect x="306.33" y="153.92" width="71.7" height="180.73"/><polygon points="540.54 403.67 446.96 356.3 522 201.13 615.58 248.49 540.54 403.67"/></g></g><polygon class="cls-2" points="104.04 160.45 110.76 159.69 105.41 163.05 103.94 160.58 104.04 160.45"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Urban Perceptions
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Creating and Deploying a Web-App
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/emilymuller1991/urban-perceptions" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Urban Perceptions" class="md-nav__button md-logo" aria-label="Urban Perceptions" data-md-component="logo">
      
  
  <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 700 700"><defs><style>.cls-1{fill:none;}.cls-2{fill:#c7c9d0;}.cls-3{clip-path:url(#clip-path);}.cls-4{clip-path:url(#clip-path-3);}.cls-5{clip-path:url(#clip-path-4);}.cls-6{clip-path:url(#clip-path-6);}</style><clipPath id="clip-path"><rect class="cls-1" x="-227.75" y="-429.57" width="1092" height="1580"/></clipPath><clipPath id="clip-path-3"><rect class="cls-1" x="572.25" y="-429.57" width="1092" height="1580"/></clipPath><clipPath id="clip-path-4"><rect class="cls-1" x="-221" y="-430.32" width="1092" height="1580"/></clipPath><clipPath id="clip-path-6"><rect class="cls-1" x="579" y="-430.32" width="1092" height="1580"/></clipPath></defs><g id="Layer_4" data-name="Layer 4"><polygon class="cls-2" points="299.62 154.69 306.36 153.9 306.33 154.99 299.62 154.69"/><polygon class="cls-2" points="515.25 201.88 522.03 201.14 520.38 204.7 515.25 201.88"/><polygon class="cls-2" points="615.51 559.5 608.82 560.21 606.76 544.65 615.18 558.56 615.51 559.5"/><polyline class="cls-2" points="608.84 560.26 609.82 560.15 615.57 559.51 615.42 559.2 608.75 560.07"/><polyline class="cls-2" points="608.91 560.25 608.83 560.26 608.8 560.19"/></g><g id="Layer_2" data-name="Layer 2"><g class="cls-3"><g class="cls-3"><path class="cls-2" d="M352.45,423c109.1,0,204.49,55.09,256.38,137.26C593.75,421.33,484.72,313.53,352.45,313.53S111.21,421.28,96.12,560.22C148,478.05,243.35,423,352.45,423"/><path class="cls-2" d="M428.05,487.89c0,42.72-33.85,77.34-75.6,77.34s-75.59-34.62-75.59-77.34,33.84-77.33,75.59-77.33,75.6,34.62,75.6,77.33"/><polygon class="cls-2" points="237.76 383.12 162.74 430.28 29 207.61 104.02 160.44 237.76 383.12"/><rect class="cls-2" x="299.58" y="154.67" width="71.7" height="180.73"/><polygon class="cls-2" points="533.79 404.42 440.21 357.05 515.25 201.88 608.83 249.24 533.79 404.42"/></g></g><polyline class="cls-2" points="102.85 559.49 96.1 560.24 106.15 543.9"/><polygon class="cls-2" points="96.1 560.24 96.22 559.29 96.24 559.97 96.17 560.21 96.1 560.24"/></g><g class="cls-5"><g class="cls-5"><path d="M359.2,422.26c109.1,0,204.49,55.09,256.38,137.26C600.5,420.58,491.47,312.78,359.2,312.78S117.91,420.58,102.82,559.52c51.9-82.17,147.28-137.26,256.38-137.26"/><path d="M434.8,487.14c0,42.72-33.85,77.34-75.6,77.34s-75.59-34.62-75.59-77.34,33.84-77.33,75.59-77.33,75.6,34.62,75.6,77.33"/><polygon points="244.51 382.37 169.49 429.53 35.75 206.86 110.77 159.69 244.51 382.37"/><rect x="306.33" y="153.92" width="71.7" height="180.73"/><polygon points="540.54 403.67 446.96 356.3 522 201.13 615.58 248.49 540.54 403.67"/></g></g><polygon class="cls-2" points="104.04 160.45 110.76 159.69 105.41 163.05 103.94 160.58 104.04 160.45"/></svg>

    </a>
    Urban Perceptions
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/emilymuller1991/urban-perceptions" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="1.download_images.html" class="md-nav__link">
        How To Download Google Street View Images
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Creating and Deploying a Web-App
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="2.web_app.html" class="md-nav__link md-nav__link--active">
        Creating and Deploying a Web-App
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#web-app-with-postgres-database-using-flask-react" class="md-nav__link">
    Web-App with Postgres Database using Flask + React
  </a>
  
    <nav class="md-nav" aria-label="Web-App with Postgres Database using Flask + React">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary-i" class="md-nav__link">
    Summary I
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements-i" class="md-nav__link">
    Requirements I
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgres-db" class="md-nav__link">
    Postgres DB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flask-back-end" class="md-nav__link">
    Flask Back-end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#react-front-end" class="md-nav__link">
    React Front-end
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-using-digitalocean-droplet-and-kubernetes-cluster" class="md-nav__link">
    Deployment using DigitalOcean Droplet and Kubernetes Cluster
  </a>
  
    <nav class="md-nav" aria-label="Deployment using DigitalOcean Droplet and Kubernetes Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary-ii" class="md-nav__link">
    Summary II
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements-ii" class="md-nav__link">
    Requirements II
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#moving-database-to-droplet" class="md-nav__link">
    Moving database to Droplet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerise-front-end-and-back-end" class="md-nav__link">
    Dockerise front-end and back-end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-with-kubernetes" class="md-nav__link">
    Deployment with Kubernetes
  </a>
  
    <nav class="md-nav" aria-label="Deployment with Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploy-database" class="md-nav__link">
    Deploy database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-postgres-settings" class="md-nav__link">
    Configuring postgres settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploying-back-end" class="md-nav__link">
    Deploying back-end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#route-dns" class="md-nav__link">
    Route DNS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-front-end" class="md-nav__link">
    Deploy front-end
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="3.deep_cnn.html" class="md-nav__link">
        Training a Convolutional Neural Network in PyTorch
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#web-app-with-postgres-database-using-flask-react" class="md-nav__link">
    Web-App with Postgres Database using Flask + React
  </a>
  
    <nav class="md-nav" aria-label="Web-App with Postgres Database using Flask + React">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary-i" class="md-nav__link">
    Summary I
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements-i" class="md-nav__link">
    Requirements I
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgres-db" class="md-nav__link">
    Postgres DB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flask-back-end" class="md-nav__link">
    Flask Back-end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#react-front-end" class="md-nav__link">
    React Front-end
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-using-digitalocean-droplet-and-kubernetes-cluster" class="md-nav__link">
    Deployment using DigitalOcean Droplet and Kubernetes Cluster
  </a>
  
    <nav class="md-nav" aria-label="Deployment using DigitalOcean Droplet and Kubernetes Cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary-ii" class="md-nav__link">
    Summary II
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements-ii" class="md-nav__link">
    Requirements II
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#moving-database-to-droplet" class="md-nav__link">
    Moving database to Droplet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerise-front-end-and-back-end" class="md-nav__link">
    Dockerise front-end and back-end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-with-kubernetes" class="md-nav__link">
    Deployment with Kubernetes
  </a>
  
    <nav class="md-nav" aria-label="Deployment with Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploy-database" class="md-nav__link">
    Deploy database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-postgres-settings" class="md-nav__link">
    Configuring postgres settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploying-back-end" class="md-nav__link">
    Deploying back-end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#route-dns" class="md-nav__link">
    Route DNS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-front-end" class="md-nav__link">
    Deploy front-end
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/emilymuller1991/urban-perceptions/tree/main/docs/2.web_app.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  



<h1 id="creating-and-deploying-a-web-app">Creating and Deploying a Web-App</h1>
<p>In this section, we will go through the necessary steps for creating a web-application using React front-end and Flask back-end. Our database of images and perception rating will be hosted in postgres. After which, we will deploy the entire app using Digital Ocean Droplet and Kubernetes services.</p>
<p><img alt="diagram of sotfwares used to deploy" src="images/architecture.png" /></p>
<h2 id="web-app-with-postgres-database-using-flask-react">Web-App with Postgres Database using Flask + React</h2>
<p>In this example, we will create a web app which displays two images side by side and the user is asked to select one, adding their rating to the database.
For more detailed instructions follow <a href="https://medium.com/@emilymuller1991/developing-a-web-app-with-postgres-database-using-flask-react-9c297606aed9">this blog</a>.</p>
<h3 id="summary-i">Summary I</h3>
<ul>
<li>Postgres Database</li>
<li>Flask back-end</li>
<li>React front-end</li>
</ul>
<h3 id="requirements-i">Requirements I</h3>
<table>
<thead>
<tr>
<th>Program</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.python.org/downloads/">Python</a></td>
<td>&gt;= 3.7</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/">Postgresql</a></td>
<td>&gt;= 11.17</td>
</tr>
<tr>
<td><a href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm">Node.js and npm</a></td>
<td>&gt;= 16.13.2</td>
</tr>
</tbody>
</table>
<ul>
<li>API key from <a href="https://console.cloud.google.com">Google Console</a>.</li>
</ul>
<h3 id="postgres-db">Postgres DB</h3>
<p>Create DB <code>example</code> as user <code>postgres</code>:</p>
<div class="highlight"><pre><span></span><code>psql postgres
postgres=# CREATE DATABASE example;
</code></pre></div>
<p>From web_app/sql/ dump ready-made data, <code>ratings</code> and <code>images</code>, into the postgres database <code>example</code>:</p>
<div class="highlight"><pre><span></span><code>web-app/sql$ psql -U postgres example &lt; ratings
web-app/sql$ psql -U postgres example &lt; images
</code></pre></div>
<h3 id="flask-back-end">Flask Back-end</h3>
<p>Set environmental variables:</p>
<div class="highlight"><pre><span></span><code>export app_host=&#39;localhost&#39;
export db=&#39;example&#39;
export db_user=&#39;postgres&#39;
export db_host=&#39;localhost&#39;
export db_port=5432
</code></pre></div>
<p>run:</p>
<div class="highlight"><pre><span></span><code>web-app/back_end$ python app.py
</code></pre></div>
<h3 id="react-front-end">React Front-end</h3>
<p>Set environmental variables in the new file web-app/front_end/.env:</p>
<div class="highlight"><pre><span></span><code>REACT_APP_BACK_END_HOST =&#39;localhost&#39;
REACT_APP_BACK_END_PORT = &#39;5000&#39;
REACT_APP_API_KEY = &#39;API_KEY_from_GOOGLE_STREET_VIEW_API&#39;
</code></pre></div>
<p>Using an api key from <a href="https://console.cloud.google.com">Google Console</a>.</p>
<p>run:</p>
<div class="highlight"><pre><span></span><code>web-app/front_end$ npm install
</code></pre></div>
<p>run:</p>
<div class="highlight"><pre><span></span><code>web-app/front_end$ npm start
</code></pre></div>
<h2 id="deployment-using-digitalocean-droplet-and-kubernetes-cluster">Deployment using DigitalOcean Droplet and Kubernetes Cluster</h2>
<p>In this section we will go through the steps needed to deploy your application using Digital Ocean cloud infrastructure.</p>
<h3 id="summary-ii">Summary II</h3>
<ul>
<li>Moving database to Droplet</li>
<li>Dockerise front-end and back-end</li>
<li>Deployment using Kubernetes</li>
</ul>
<h3 id="requirements-ii">Requirements II</h3>
<table>
<thead>
<tr>
<th>Program</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.python.org/downloads/">Python</a></td>
<td>&gt;= 3.7</td>
</tr>
<tr>
<td><a href="https://www.postgresql.org/">Postgresql</a></td>
<td>&gt;= 11.17</td>
</tr>
<tr>
<td><a href="https://nodejs.org/en/">Node.js</a></td>
<td>&gt;= 16.13.2</td>
</tr>
<tr>
<td><a href="https://www.docker.com/">Docker</a></td>
<td>&gt;= 20.10.18</td>
</tr>
<tr>
<td><a href="https://kubernetes.io/docs/tasks/tools/">kubectl</a></td>
<td>==v1.20.2</td>
</tr>
</tbody>
</table>
<ul>
<li><a href="https://www.gandi.net/en">A web domain</a>.</li>
<li>DockerHub credentials</li>
<li>DigitalOcean, <a href="https://docs.digitalocean.com/products/droplets/how-to/connect-with-ssh/">Droplet</a> + Kubernetes Cluster</li>
</ul>
<h3 id="moving-database-to-droplet">Moving database to Droplet</h3>
<p>Once you have created a Droplet, configured your root password and created a new user, your droplet IP address will show. You can ssh into your droplet from your local machine:</p>
<div class="highlight"><pre><span></span><code>ssh user@IP.address
</code></pre></div>
<p>In your Droplet, <a href="https://www.postgresql.org/download/">install postgres</a> and postgres-client (below). Create example database:</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install postgresql-client
psql postgres
postgres=# CREATE DATABASE example;
\q
</code></pre></div>
<p>We'll now copy the local file, <code>into_droplet</code>, to the remote Droplet using <a href="https://www.digitalocean.com/community/tutorials/how-to-use-sftp-to-securely-transfer-files-with-a-remote-server">sftp</a>.</p>
<div class="highlight"><pre><span></span><code>urban_perceptions/web_app/sql$ sftp user@IP.address
sftp&gt; put into_droplet
sftp? Ctrl + D
</code></pre></div>
<p>If you ls in the directory, you will see the file <code>into_droplet</code> has copied over to your Digital Ocean Droplet. ssh back into your droplet and pg_dump the into_droplet file into your example database:</p>
<div class="highlight"><pre><span></span><code>ssh user@IP.address
droplet$ psql example &lt; into_droplet
droplet$ psql -d example
example=# \dn+
</code></pre></div>
<p>You should see a list of schemas in the database.</p>
<h3 id="dockerise-front-end-and-back-end">Dockerise front-end and back-end</h3>
<p>In this section we will dockerise our front-ends and back-ends.</p>
<div class="highlight"><pre><span></span><code>npm run-script build
docker build --no-cache --pull --force-rm -t front-end-example .
</code></pre></div>
<p>Inspect docker images using 'docker images', you should now see front-end-example as the latest image. Run the image using:</p>
<div class="highlight"><pre><span></span><code>docker run -it -p 4000:80 front-end-example:latest
</code></pre></div>
<p>This should launch the React app at the <a href="http://localhost:4000">localhost:4000</a>. We'll now push the docker image to DockerHub. Get the image tag from 'docker images' and tag it:</p>
<div class="highlight"><pre><span></span><code>docker tag [IMAGEID] username/example-front-end
docker push username/example-front-end
</code></pre></div>
<p>If you visit DockerHub, you should now see the image available on the server. Let's follow similar steps for the back-end. Within the back-end dir enter:</p>
<div class="highlight"><pre><span></span><code>docker build --no-cache --pull --force-rm -t back-end-example .
</code></pre></div>
<p>Once this is complete run the image:</p>
<div class="highlight"><pre><span></span><code>docker run -it --network=&quot;host&quot; --env db_host=&#39;localhost&#39; --env db_port=5432 --env db_root_password=&#39;[POSTGRES_PASSWORD]&#39; back-end:latest /bin/bash
</code></pre></div>
<p>This will require you to update your local postgres settings so <a href="https://stackoverflow.com/questions/31249112/allow-docker-container-to-connect-to-a-local-host-postgres-database">listen to on all addresses</a>.
Continue to push the docker image to DockerHub as with front-end.</p>
<h3 id="deployment-with-kubernetes">Deployment with Kubernetes</h3>
<h4 id="deploy-database">Deploy database</h4>
<p>Once you have your DigitalOcean Kubernetes cluster and kubectl command line tool, we will begin by connecting the cluster to our external postgres db. To do so run:</p>
<div class="highlight"><pre><span></span><code>sudo kubectl apply -f sql/db.yaml
</code></pre></div>
<p>where PRIVATE_IP_DROPLET in the db.yaml file is configured to your digital ocean droplet private IP address. Once this is configured, run:</p>
<div class="highlight"><pre><span></span><code>sudo kubectl describe services --namespace postgres
</code></pre></div>
<p>to get the IP address of the postgres endpoint. We will need this to configure postgres on the droplet to listen to and to connect to the postgres DB from the back-end.</p>
<h4 id="configuring-postgres-settings">Configuring postgres settings</h4>
<p>We will have to configure remote access to postgres in the Droplet by <a href="https://blog.jsinh.in/how-to-enable-remote-access-to-postgresql-database-server/#.VZqPgnXInK5">changing some configuration files</a>.</p>
<p>First change the listening address to listen_addresses = '*':</p>
<div class="highlight"><pre><span></span><code>vim /etc/postgresql/13/main/postgresql.conf
</code></pre></div>
<p>Then, add the postgres endpoint IP to the postgres config file:</p>
<div class="highlight"><pre><span></span><code>vim /etc/postgresql/13/main/pg_hba.conf
</code></pre></div>
<p>adding under IPV4 addresses the following:</p>
<div class="highlight"><pre><span></span><code>host    all             all             [POSTGRES_ENDPOINT_IP]/24        md5
</code></pre></div>
<p>If there are any issues with the password, then these can be amended by changing md5 to trust.</p>
<h4 id="deploying-back-end">Deploying back-end</h4>
<p>Now that we have configured out postgres endpoint from the cluster to the droplet, we will deploy the backend. In back_end/back-end.yml configure username/BACK_END_CONTAINER, POSTGRES_ENDPOINT_IP, POSTGRES_USER_PASSWORD. Once that is complete run:</p>
<div class="highlight"><pre><span></span><code>sudo kubectl apply -f back-end.yml
</code></pre></div>
<p>This will create a back-end deployment, and a back-end service. The back-end service IP will be needed for the front-end to request from. Make a note of the external IP by running:</p>
<div class="highlight"><pre><span></span><code>sudo kubectl get svc
</code></pre></div>
<h4 id="route-dns">Route DNS</h4>
<p><a href="https://docs.digitalocean.com/tutorials/dns-registrars/">Configure your DNS registrar</a> to point to Digital Ocean from the site where you purchased your web domain.</p>
<h4 id="deploy-front-end">Deploy front-end</h4>
<p>In front_end/front-end-ingress.yml configure WEB_DOMAIN and username/FRONT_END_CONTAINER. Then run:</p>
<div class="highlight"><pre><span></span><code>sudo kubectl apply -f front-end-ingress.yml
</code></pre></div>
<p>Expose the front-end deployment to a LoadBalancer (which we will use in the next step to route IP):</p>
<div class="highlight"><pre><span></span><code>sudo kubectl expose deployment front-end --type=LoadBalancer --name=[name-of-load-balancer]
</code></pre></div>
<p>Get the external IP address of the LoadBalancer using</p>
<div class="highlight"><pre><span></span><code>sudo kubectl get svc
</code></pre></div>
<p><a href="https://docs.digitalocean.com/products/networking/dns/how-to/manage-records/">Create a new A type DNS record</a> in Digital Ocean that is linked to the LoadBalancer's external IP address.</p>
<p>Finally, create a configmap which will host environmental variables for the React App.</p>
<div class="highlight"><pre><span></span><code>kubectl create configmap front-end-config --from-file=config.js=dev.properties --dry-run -o yaml \
    | kubectl apply -f -
</code></pre></div>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="1.download_images.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: How To Download Google Street View Images" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              How To Download Google Street View Images
            </div>
          </div>
        </a>
      
      
        
        <a href="3.deep_cnn.html" class="md-footer__link md-footer__link--next" aria-label="Next: Training a Convolutional Neural Network in PyTorch" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Training a Convolutional Neural Network in PyTorch
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.instant", "navigation.top", "toc.follow", "content.code.annotate"], "search": "assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>